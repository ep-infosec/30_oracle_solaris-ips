<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE refentry PUBLIC "-//Sun Microsystems//DTD SolBook-XML 3.7//EN" "xsolbook.dtd" [
<!ENTITY % ent SYSTEM "entities.ent">
%ent;
]>

<refentry id="pkgrepo-1">
<refmeta><refentrytitle>pkgrepo</refentrytitle><manvolnum>1</manvolnum> <refmiscinfo class="date">2 Apr 2020</refmiscinfo> <refmiscinfo class="sectdesc">&man1;</refmiscinfo> <refmiscinfo class="software">&release;</refmiscinfo> <refmiscinfo class="arch">generic</refmiscinfo> <refmiscinfo class="copyright">Copyright (c) 2007, 2020, Oracle and/or its affiliates.</refmiscinfo>
</refmeta>
<refnamediv>
<refname>pkgrepo</refname><refpurpose>映像包管理系统的系统信息库管理实用程序</refpurpose></refnamediv>
<refsynopsisdiv><title></title>
<synopsis>/usr/bin/pkgrepo create [--version <replaceable>ver</replaceable>] <replaceable>uri_or_path</replaceable></synopsis>
<synopsis>/usr/bin/pkgrepo add-publisher -s <replaceable>repo_uri_or_path</replaceable>
    <replaceable>publisher</replaceable> ...</synopsis>
<synopsis>/usr/bin/pkgrepo remove-publisher [-n] [--synchronous]
    -s <replaceable>repo_uri_or_path</replaceable> <replaceable>publisher</replaceable> ...</synopsis>
<synopsis>/usr/bin/pkgrepo get [-F <replaceable>format</replaceable>] [-H] [-p <replaceable>publisher</replaceable>]...
    -s <replaceable>repo_uri_or_path</replaceable> [--key <replaceable>ssl_key</replaceable> --cert <replaceable>ssl_cert</replaceable>]...
    [<replaceable>section/property</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkgrepo info [-F <replaceable>format</replaceable>] [-H] [-p <replaceable>publisher</replaceable>]...
    -s <replaceable>repo_uri_or_path</replaceable> [--key <replaceable>ssl_key</replaceable> --cert <replaceable>ssl_cert</replaceable>]...</synopsis>
<synopsis>/usr/bin/pkgrepo list [-F <replaceable>format</replaceable>] [-H] [-p <replaceable>publisher</replaceable>]...
    -s <replaceable>repo_uri_or_path</replaceable> [--key <replaceable>ssl_key</replaceable> --cert <replaceable>ssl_cert</replaceable>]...
    [<replaceable>pkg_fmri_pattern</replaceable> ...]</synopsis>
<synopsis>/usr/bin/pkgrepo contents [-m]
    [-t <replaceable>action_name</replaceable>[,<replaceable>action_name</replaceable>]...]... -s <replaceable>repo_uri_or_path</replaceable>
    [--key <replaceable>ssl_key</replaceable> --cert <replaceable>ssl_cert</replaceable>]... [<replaceable>pkg_fmri_pattern</replaceable>...]</synopsis>
<synopsis>/usr/bin/pkgrepo rebuild [-p <replaceable>publisher</replaceable>]...
    -s <replaceable>repo_uri_or_path</replaceable> [--key <replaceable>ssl_key</replaceable> --cert <replaceable>ssl_cert</replaceable>]...
    [--no-catalog] [--no-index]</synopsis>
<synopsis>/usr/bin/pkgrepo refresh [-p <replaceable>publisher</replaceable>]...
    -s <replaceable>repo_uri_or_path</replaceable> [--key <replaceable>ssl_key</replaceable> --cert <replaceable>ssl_cert</replaceable>]...
    [--no-catalog] [--no-index]</synopsis>
<synopsis>/usr/bin/pkgrepo remove [-n] [-p <replaceable>publisher</replaceable>]...
    -s <replaceable>repo_uri_or_path</replaceable> <replaceable>pkg_fmri_pattern</replaceable> ...</synopsis>
<synopsis>/usr/bin/pkgrepo set [-p <replaceable>publisher</replaceable>]... -s <replaceable>repo_uri_or_path</replaceable>
    <replaceable>section/property</replaceable>=[<replaceable>value</replaceable>] ...</synopsis>
<synopsis>/usr/bin/pkgrepo set [-p <replaceable>publisher</replaceable>]... -s <replaceable>repo_uri_or_path</replaceable>
    <replaceable>section/property</replaceable>=([<replaceable>value</replaceable>]) ...</synopsis>
<synopsis>/usr/bin/pkgrepo verify [-d] [-p <replaceable>publisher</replaceable>]...
    [-i <replaceable>ignored_dep_file</replaceable>]...  [--disable <replaceable>verification</replaceable>]...
    -s <replaceable>repo_uri_or_path</replaceable></synopsis>
<synopsis>/usr/bin/pkgrepo fix [-v] [-p <replaceable>publisher</replaceable>]...
    -s <replaceable>repo_uri_or_path</replaceable></synopsis>
<synopsis>/usr/bin/pkgrepo diff [-vq] [--strict] [--parsable] [-p <replaceable>publisher</replaceable>]...
    -s <replaceable>first_repo_uri_or_path</replaceable> [--key <replaceable>ssl_key</replaceable> --cert <replaceable>ssl_cert</replaceable>]...
    -s <replaceable>second_repo_uri_or_path</replaceable> [--key <replaceable>ssl_key</replaceable> --cert <replaceable>ssl_cert</replaceable>]...</synopsis>
<synopsis>/usr/bin/pkgrepo help</synopsis>
<synopsis>/usr/bin/pkgrepo version</synopsis>
</refsynopsisdiv>
<refsect1 id="pkgrepo-1-desc" role="description"><title></title>
<para><command>pkgrepo</command> provides the ability to create and manage <olink targetdoc="refman" targetptr="pkg-7"><citerefentry><refentrytitle>pkg</refentrytitle><manvolnum>7</manvolnum></citerefentry></olink> package repositories.软件包系统信息库是一组预定义的目录和文件，允许 <command>pkg</command> 和发布客户机（例如 <command>pkgsend </command> 或 <command>pkgrecv</command>）存储和检索软件包数据。此外，当需要对软件包系统信息库进行基于网络的访问时，<command>pkg.depotd</command> 可以提供对该系统信息库的客户机访问权限，以存储和/或检索软件包数据。</para>
</refsect1>
<refsect1 role="options"><title></title>
<para>支持以下选项：</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>?</option></term><term><option>-help</option></term>
<listitem><para>显示用法消息。</para>
</listitem>
</varlistentry>
</variablelist>
</refsect1>
<refsect1 role="subcommands"><title></title>
<para>支持以下子命令：</para>
<variablelist termlength="wholeline">
<varlistentry><term><command>pkgrepo create</command> [<option>-version</option> <replaceable>ver</replaceable>] <replaceable>uri_or_path</replaceable></term>
<listitem><para>Create a <olink targetdoc="refman" targetptr="pkg-7"><citerefentry><refentrytitle>pkg</refentrytitle><manvolnum>7</manvolnum></citerefentry></olink> repository at the specified location.</para>
<para>该子命令仅可以与基于文件系统的系统信息库一起使用。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>-version</option></term>
<listitem><para>使用与指定版本兼容的格式创建系统信息库。缺省情况下，会创建版本为 4 的系统信息库。Supported versions are:</para>
<variablelist>
<varlistentry><term>3</term>
<listitem><para>支持为单个发布者存储软件包，目录版本为 1 ，搜索版本为 1。</para>
</listitem>
</varlistentry>
<varlistentry><term>4</term>
<listitem><para>支持为多个发布者存储软件包，目录版本为 1 ，搜索版本为 1。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo add-publisher</command> <option>s</option> <replaceable>repo_uri_or_path</replaceable> <replaceable>publisher</replaceable> ...</term>
<listitem><para>将指定的发布者添加到系统信息库中。新的发布者没有软件包或内容。</para>
<para>该子命令仅可以与基于第 4 版文件系统的系统信息库一起使用。
</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>s</option> <replaceable>repo_uri_or_path</replaceable></term>
<listitem><para>对位于给定 URI 或文件系统路径的系统信息库进行操作。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo remove-publisher</command> [<option>n</option>] [<option>-synchronous</option>] <option>s</option> <replaceable>repo_uri_or_path</replaceable> <replaceable>publisher</replaceable> ...</term>
<listitem><para>从系统信息库中删除指定的发布者。删除指定发布者的所有软件包和其他所有数据。</para>
<para>如果删除了缺省发布者，并且系统信息库中只剩余了一个发布者，则剩余的发布者将成为缺省发布者。系统信息库的 <literal>publisher/prefix</literal> 属性将设置为该剩余发布者。</para>
<para>如果删除了缺省发布者，但系统信息库中剩余多个发布者，或者从系统信息库中删除了最后一个发布者，则将取消设置 <literal>publisher/prefix</literal> 属性。</para>
<para>该子命令仅可以与基于第 4 版文件系统的系统信息库一起使用。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>n</option></term>
<listitem><para>试运行操作而不更改发布者。在退出之前，会显示要删除的每个发布者的软件包个数。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>s</option> <replaceable>repo_uri_or_path</replaceable></term>
<listitem><para>对位于给定 URI 或文件系统路径的系统信息库进行操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-synchronous</option></term>
<listitem><para>等待操作完成，然后返回。如果未指定此选项，命令将立即返回并在后台异步删除发布者。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo get</command> [<option>F</option> <replaceable>format</replaceable>] [<option>H</option>] [<option>p</option> <replaceable>publisher</replaceable>]... <option>s</option> <replaceable>repo_uri_or_path</replaceable> [<option>-key</option> <replaceable>ssl_key</replaceable> <option>-cert</option> <replaceable>ssl_cert</replaceable>]... [<replaceable>section/property</replaceable> ...]</term>
<listitem><para>显示系统信息库或其发布者的属性信息。</para>
<para>缺省情况下，会在单独的行中列显每个属性及其值。空的 ASCII 字符串值用一对双引号 (<literal>""</literal>) 表示。ASCII 字符串值中的以下 Bourne shell 元字符以及换行符、空格符和制表符都必须使用反斜杠 (<literal>\</literal>) 进行转义：</para>
<programlisting>; &amp; ( ) | ^ &lt; > &bsol; " ' `</programlisting>
<para>有关显示发布者和系统信息库属性的示例，请参见“示例”部分。</para>
<para>有关属性列表以及每个属性的用途和值，请参见下文的 <command>set</command> 子命令。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>F</option> <replaceable>format</replaceable></term>
<listitem><para>指定备用输出格式。<replaceable>format</replaceable> 的值可以是 <literal>tsv</literal>（以制表符分隔的值）、<literal>json</literal>（单行 JavaScript 对象表示法）或 <literal>json-formatted</literal>（格式易于阅读的 JavaScript 对象表示法）。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>H</option></term>
<listitem><para>在列出时省略标题。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>显示给定发布者的属性信息。特殊值 <literal>all</literal> 显示所有发布者的属性。可以多次指定此选项。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>s</option> <replaceable>repo_uri_or_path</replaceable></term>
<listitem><para>对位于给定 URI 或文件系统路径的系统信息库进行操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-key</option> <replaceable>ssl_key</replaceable> <option>-cert</option> <replaceable>ssl_cert</replaceable></term>
<listitem><para>使用 <option>-key</option> 选项指定用于从 HTTPS 系统信息库进行软件包检索的客户机 SSL 密钥文件。使用 <option>-cert</option> 选项指定用于从 HTTPS 系统信息库进行软件包检索的客户机 SSL 证书文件。可以多次指定此选项对。</para>
</listitem>
</varlistentry>
<varlistentry><term><replaceable>section/property</replaceable></term>
<listitem><para>仅显示指定属性的值，例如 <literal> publisher/prefix</literal> 或 <literal>repository/version</literal>。有关完整的属性列表，请参见 <command> set</command> 子命令。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo info</command> [<option>F</option> <replaceable>format</replaceable>] [<option>H</option>] [<option>p</option> <replaceable>publisher</replaceable>]... <option>s</option> <replaceable>repo_uri_or_path</replaceable> [<option>-key</option> <replaceable>ssl_key</replaceable> <option>-cert</option> <replaceable>ssl_cert</replaceable>]...</term>
<listitem><para>显示系统信息库已知的软件包发布者的列表。该列表包括每个发布者的软件包数量、最后一次更新发布者的软件包数据的时间以及发布者的软件包数据的状态（例如当前是否处于正在处理状态）。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>仅显示给定发布者的数据。如果没有提供该选项，将显示所有发布者的数据。可以多次指定此选项。</para>
</listitem>
</varlistentry>
</variablelist>
<para>有关其他所有选项的说明，请参见上面的 <command>pkgrepo get</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo list</command> [<option>F</option> <replaceable>format</replaceable>] [<option>H</option>] [<option>p</option> <replaceable>publisher</replaceable>]... <option>s</option> <replaceable>repo_uri_or_path</replaceable> [<option>-key</option> <replaceable>ssl_key</replaceable> <option>-cert</option> <replaceable>ssl_cert</replaceable>]... [<replaceable>pkg_fmri_pattern</replaceable> ...]</term>
<listitem><para>列出 <replaceable>repo_uri_or_path</replaceable> 系统信息库中与指定 <replaceable>pkg_fmri_pattern</replaceable> 模式匹配的软件包。如果未指定任何模式，将列出系统信息库中的所有软件包。The <replaceable>pkg_fmri_pattern</replaceable> pattern can include the <literal>?</literal> and <literal>*</literal> characters as <olink targetdoc="refman" targetptr="glob-3C"><citerefentry><refentrytitle>glob</refentrytitle><manvolnum>3C</manvolnum></citerefentry></olink>-style wildcards to match one or more packages.</para>
<para>在缺省输出中，第一列包含软件包发布者的名称。第二列包含软件包的名称。第三列是显示软件包状态的标志。状态列中的 <literal>o</literal> 值表示软件包已过时。状态列中的 <literal>r</literal> 值表示已重命名软件包，但格式已过时。A value of <literal>l</literal> in the status column indicates the package is legacy, meaning that it will be removed in the future.第四列包含软件包的发行版本和分支版本。See <olink targetdoc="refman" targetptr="pkg-7"><citerefentry><refentrytitle>pkg</refentrytitle><manvolnum>7</manvolnum></citerefentry></olink> for information about release and branch versions.</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>仅显示给定发布者的软件包。如果没有提供该选项，将列出所有发布者的软件包。可以多次指定此选项。</para>
</listitem>
</varlistentry>
</variablelist>
<para>有关其他所有选项的说明，请参见上面的 <command>pkgrepo get</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo contents</command> [<option>m</option> [<option>t</option> <replaceable>action_name</replaceable>[,<replaceable>action_name</replaceable>]...]... <option>s</option> <replaceable>repo_uri_or_path</replaceable> [<option>-key</option> <replaceable>ssl_key</replaceable> <option>-cert</option> <replaceable>ssl_cert</replaceable>]... [<replaceable>pkg_fmri_pattern</replaceable>...]</term>
<listitem><para>列出 <replaceable>repo_uri_or_path</replaceable> 系统信息库中的所有软件包。如果指定了 <replaceable>pkg_fmri_pattern</replaceable>，将显示系统信息库中所有匹配软件包的内容（操作属性）。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>m</option></term>
<listitem><para>显示指定软件包中操作的所有属性。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>t</option> <replaceable>action_name</replaceable></term>
<listitem><para>仅显示指定软件包中的指定操作。可以多次指定 <option>t</option> 选项；也可以通过使用逗号分隔操作名称，将多个操作指定为一个 <option>t</option> 选项的参数。The value of <replaceable>action_name</replaceable> is one of the actions listed in “Actions” in the <olink targetdoc="refman" targetptr="pkg-7"><citerefentry><refentrytitle>pkg</refentrytitle><manvolnum>7</manvolnum></citerefentry></olink> man page, such as <literal>file</literal>, <literal>dir</literal>, <literal>driver</literal>, <literal>depend</literal>, or <literal>set</literal>.</para>
</listitem>
</varlistentry>
</variablelist>
<para>有关其他所有选项的说明，请参见上面的 <command>pkgrepo get</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo rebuild</command> [<option>p</option> <replaceable>publisher</replaceable>]... <option>s</option> <replaceable>repo_uri_or_path</replaceable> [<option>-key</option> <replaceable>ssl_key</replaceable> <option>-cert</option> <replaceable>ssl_cert</replaceable>]... [<option>-no-catalog</option>] [<option>-no-index</option>]</term>
<listitem><para>放弃在系统信息库中找到的所有目录、搜索以及其他缓存信息，然后根据系统信息库的当前内容重新创建这些信息。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>仅针对给定发布者执行操作。如果没有提供该选项或者指定了特定值 <literal>all</literal>，则对所有发布者执行操作。可以多次指定此选项。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-catalog</option></term>
<listitem><para>不重新生成软件包数据。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-index</option></term>
<listitem><para>不重新生成搜索索引。</para>
</listitem>
</varlistentry>
</variablelist>
<para>有关其他所有选项的说明，请参见上面的 <command>pkgrepo get</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo refresh</command> [<option>p</option> <replaceable>publisher</replaceable>]... <option>s</option> <replaceable>repo_uri_or_path</replaceable> [<option>-key</option> <replaceable>ssl_key</replaceable> <option>-cert</option> <replaceable>ssl_cert</replaceable>]... [<option>-no-catalog</option>] [<option>-no-index</option>] </term>
<listitem><para>将在系统信息库中找到的所有新软件包编入目录并更新所有搜索索引。这主要供延迟的发布使用（<command>pkgsend</command> 的 <option>-no-catalog </option> 或 <option>-no-index</option> 选项）。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>仅针对给定发布者执行操作。如果没有提供该选项或者指定了特定值 <literal>all</literal>，则对所有发布者执行操作。可以多次指定此选项。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-catalog</option></term>
<listitem><para>不添加任何新软件包。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-no-index</option></term>
<listitem><para>不更新搜索索引。</para>
</listitem>
</varlistentry>
</variablelist>
<para>有关其他所有选项的说明，请参见上面的 <command>pkgrepo get</command> 命令。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo remove</command> [<option>n</option>] [<option>p</option> <replaceable>publisher</replaceable>]... <option>s</option> <replaceable>repo_uri_or_path</replaceable> <replaceable>pkg_fmri_pattern</replaceable> ...</term>
<listitem><para>从系统信息库中删除与指定的 <replaceable>pkg_fmri_pattern</replaceable> 模式匹配的软件包，其中包括这些软件包所引用的且未被其他任何软件包使用的所有文件。The <replaceable>pkg_fmri_pattern</replaceable> pattern can include the <literal>?</literal> and <literal>*</literal> characters as <olink targetdoc="refman" targetptr="glob-3C"><citerefentry><refentrytitle>glob</refentrytitle><manvolnum>3C</manvolnum></citerefentry></olink>-style wildcards to match one or more packages.</para>
<note><para>删除关联发布者的所有搜索索引数据。</para>
</note>
<para>该子命令仅可以与基于文件系统的系统信息库一起使用。</para>
<caution><para>此操作不可逆并且不得在其他客户机正在访问系统信息库时使用，因为这样会使得它们在执行检索操作期间出现故障。</para></caution>
<variablelist termlength="wholeline">
<varlistentry><term><option>n</option></term>
<listitem><para>试运行操作而不进行软件包更改。在退出之前，会显示要删除的软件包的列表。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>仅删除给定发布者的匹配软件包。如果没有提供该选项，会删除所有发布者的所有匹配软件包。可以多次指定此选项。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>s</option> <replaceable>repo_uri_or_path</replaceable></term>
<listitem><para>对位于给定 URI 或文件系统路径的系统信息库进行操作。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo set</command> [<option>p</option> <replaceable>publisher</replaceable>]... <option>s</option> <replaceable>repo_uri_or_path</replaceable> <replaceable>section/property</replaceable>=[<replaceable>value</replaceable>] ...</term><term><command>pkgrepo set</command> [<option>p</option> <replaceable>publisher</replaceable>]... <option>s</option> <replaceable>repo_uri_or_path</replaceable> <replaceable>section/property</replaceable>=([<replaceable>value</replaceable>]) ...</term>
<listitem><para>为系统信息库或发布者设置指定属性的值。</para>
<para>该子命令仅可以与基于文件系统的系统信息库一起使用。</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>仅为给定发布者设置属性数据。如果发布者尚未存在，将添加该发布者。特殊值 <literal> all</literal> 可用于设置所有发布者的属性。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>s</option> <replaceable>repo_uri_or_path</replaceable></term>
<listitem><para>对位于给定 URI 或文件系统路径的系统信息库进行操作。</para>
</listitem>
</varlistentry>
</variablelist>
<para>可以使用以下格式之一指定属性和值：</para>
<variablelist termlength="wholeline">
<varlistentry><term><replaceable>section</replaceable>/<replaceable>property</replaceable>=</term>
<listitem><para>清除属性值。</para>
</listitem>
</varlistentry>
<varlistentry><term><replaceable>section</replaceable>/<replaceable>property</replaceable>=<replaceable>value</replaceable></term>
<listitem><para>将属性值替换为给定值。</para>
</listitem>
</varlistentry>
<varlistentry><term><replaceable>section</replaceable>/<replaceable>property</replaceable>=(<replaceable>value1</replaceable> <replaceable>value2</replaceable> <replaceable>valueN</replaceable>)</term>
<listitem><para>将属性值替换为值列表。</para>
</listitem>
</varlistentry>
</variablelist>
<para>对于系统信息库第 3 和 4 版，可以为系统信息库设置以下属性：</para>
<variablelist termlength="wholeline">
<varlistentry><term><literal>publisher/prefix</literal></term>
<listitem><para>代表缺省发布者名称的字符串。第一个字符必须是 a-z、A-Z 或 0-9。该字符串的剩余部分只能包含字符 0-9、-、.、a-z 以及 A-Z。该值指示存在多个发布者的软件包时或者将软件包发布到系统信息库但没有指定发布者时，应当使用的发布者。</para>
</listitem>
</varlistentry>
</variablelist>
<para>对于系统信息库第 3 版和第 4 版，可以为系统信息库中的各发布者设置以下属性。设置这些属性时应使用 <option>p</option> 选项至少指定一个发布者。</para>
<variablelist termlength="wholeline">
<varlistentry><term><literal>publisher/alias</literal></term>
<listitem><para>字符串，代表在使用系统信息库的配置数据添加发布者时客户机应当使用的缺省别名。第一个字符必须是 a-z、A-Z 或 0-9。该字符串的剩余部分只能包含字符 0-9、-、.、a-z 以及 A-Z。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/check-certificate-revocation</literal></term>
<listitem><para>用于检查证书是否已撤销的布尔值。如果此属性设置为 <literal>True</literal>，则 <command>pkgrepo verify</command> 和 <command>pkgrepo fix</command> 命令将尝试访问用于签名验证的证书中的任何 CRL 分发点，以确定证书自颁发以来是否已被撤销。缺省值为 <literal>False</literal>。此属性仅由 <command>verify</command> 和 <command>fix</command> 子命令用来验证系统信息库的内容。此属性不影响客户机设置。This value should be the same as the corresponding <olink targetdoc="refman" targetptr="pkg-1"><citerefentry><refentrytitle>pkg</refentrytitle><manvolnum>1</manvolnum></citerefentry></olink> property value.</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/collection_type</literal></term>
<listitem><para>可以使用值 <literal>core</literal> 或 <literal>supplemental</literal>，表明此系统信息库中提供的软件包类型。</para>
<para><literal>core</literal> 类型表明系统信息库包含该库中的软件包所声明的所有依赖项。<literal>core</literal> 类型主要用于操作系统的系统信息库。</para>
<para><literal>supplemental</literal> 类型表明系统信息库包含依赖于另一个系统信息库中的软件包或要与另一个系统信息库中软件包一起使用的软件包。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/description</literal></term>
<listitem><para>纯文本段落，描述系统信息库的用途和内容。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/detailed_url</literal></term>
<listitem><para>URI，代表提供更多有关系统信息库信息的文档的位置（例如网页）。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/legal_uris</literal></term>
<listitem><para>文档的位置列表 (URI)，提供关于系统信息库的其他法律信息。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/mirrors</literal></term>
<listitem><para>系统信息库的位置列表 (URI)，这些系统信息库包含系统信息库的软件包内容的副本但不包含软件包元数据。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/name</literal></term>
<listitem><para>纯文本字符串，包含系统信息库的名称。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/origins</literal></term>
<listitem><para>系统信息库的位置列表 (URI)，这些系统信息库包含该系统信息库的软件包元数据和内容的完整副本。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/refresh_seconds</literal></term>
<listitem><para>整数值，表示客户机在每次更新检查之后和检查系统信息库以查找更新的软件包数据之前应当等待的秒数。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/registration_uri</literal></term>
<listitem><para>代表资源位置的 URI，必须使用该位置才能获取访问系统信息库的证书。注册网页就是一个示例。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/related_uris</literal></term>
<listitem><para>系统信息库的位置列表 (URI)，这些系统信息库包含用户可能感兴趣的软件包。</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/signature-required-names</literal></term>
<listitem><para>在验证软件包签名时必须视为证书通用名称的名称列表。此属性仅由 <command>verify</command> 和 <command>fix</command> 子命令用来验证系统信息库的内容。此属性不影响客户机设置。These values should be the same as the corresponding <olink targetdoc="refman" targetptr="pkg-1"><citerefentry><refentrytitle>pkg</refentrytitle><manvolnum>1</manvolnum></citerefentry></olink> property values.</para>
</listitem>
</varlistentry>
<varlistentry><term><literal>repository/trust-anchor-directory</literal></term>
<listitem><para>目录的绝对路径名称，包含此系统信息库中的软件包的信任锚。如果未指定，将使用 <filename>/etc/certs/CA/</filename>。此属性仅由 <command>verify</command> 和 <command>fix</command> 子命令用来验证系统信息库的内容。此属性不影响客户机设置。This value should be the same as the corresponding <olink targetdoc="refman" targetptr="pkg-1"><citerefentry><refentrytitle>pkg</refentrytitle><manvolnum>1</manvolnum></citerefentry></olink> property value.</para>
</listitem>
</varlistentry>
</variablelist>
<para>此处没有记录但列在 <command>get</command> 子命令输出中的属性均保留供内部使用，不应对其进行设置。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo verify</command> [<option>d</option>] [<option>p</option> <replaceable>publisher</replaceable>]... [<option>i</option> <replaceable>ignored_dep_file</replaceable>]... [<option>-disable</option> <replaceable>verification</replaceable>]... <option>s</option> <replaceable>repo_uri_or_path</replaceable></term>
<listitem><para>验证软件包系统信息库内容的以下属性是否正确：</para>
<itemizedlist>
<listitem><para>文件校验和</para></listitem>
<listitem><para>文件权限</para><para>还将检查指向系统信息库的路径，确保 <literal>pkg5srv</literal> 用户可以读取系统信息库内容。对于在系统具有非全局区域时使用 <literal>svc:/application/pkg/server</literal> 服务或使用 <literal>svc:/application/pkg/system-repository</literal> 服务变为可用的系统信息库，需要进行此检查。</para>
</listitem>
<listitem><para>软件包清单权限</para></listitem>
<listitem><para>软件包清单内容（包括依赖项）</para><para>依赖项检查过程验证每个软件包清单中引用的每个文件是否在系统信息库中。另请参见下面的 <option>d</option>、<option>i</option> 和 <option>-disable</option> 选项。</para></listitem>
<listitem><para>软件包签名</para><para>基于 <literal>repository/signature-required-names</literal>、<literal>repository/trust-anchor-directory</literal> 和 <literal>repository/check-certificate-revocation</literal> 属性的值计算软件包清单签名。</para>
</listitem>
</itemizedlist>
<para>相应错误将发送到 <literal>stdout</literal>。如果发送任何错误，则 <command>pkgrepo</command> 命令将退出并显示非零返回代码。</para>
<para>该子命令仅可以与基于第 4 版文件系统的系统信息库一起使用。
</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>仅针对指定发布者执行操作。如果没有指定发布者或者指定了特定值 <literal>all</literal>，则对所有发布者执行操作。可以多次指定此选项。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>d</option></term>
<listitem><para>执行完整的依赖性验证。此选项不能与 <command>--disable dependency</command> 一起使用。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>i</option> <replaceable>ignored_dep_file</replaceable></term>
<listitem><para>执行依赖性验证，但忽略文件中指定的依赖性。此选项不能与 <command>--disable dependency</command> 一起使用。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-disable</option> <replaceable>verification</replaceable></term>
<listitem><para>禁用指定的验证。当前的允许值：<literal>dependency</literal>。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>s</option> <replaceable>repo_uri_or_path</replaceable></term>
<listitem><para>对位于给定 URI 或文件系统路径的系统信息库进行操作。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo fix</command> [<option>v</option>] [<option>p</option> <replaceable>publisher</replaceable>]。。。 <option>s</option> <replaceable>repo_uri_or_path</replaceable></term>
<listitem><para>通过以下方法修复系统信息库的内容：首先验证系统信息库，然后将所有无效系统信息库内容移至系统信息库内的隔离目录。</para>
<para>如果发现系统信息库错误，将自动执行系统信息库重新生成操作。If any errors are found, a message is emitted to <literal>stdout</literal> showing which packages must be re-imported using <olink targetdoc="refman" targetptr="pkgsend-1"><citerefentry><refentrytitle>pkgsend</refentrytitle><manvolnum>1</manvolnum></citerefentry></olink> or <olink targetdoc="refman" targetptr="pkgrecv-1"><citerefentry><refentrytitle>pkgrecv</refentrytitle><manvolnum>1</manvolnum></citerefentry></olink> in order to restore the repository contents.</para>
<para>该子命令仅可以与基于第 4 版文件系统的系统信息库一起使用。
</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>v</option></term>
<listitem><para>包括详细说明系统信息库验证过程中发现的错误的输出。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>仅针对指定发布者执行操作。如果没有指定发布者或者指定了特定值 <literal>all</literal>，则对所有发布者执行操作。可以多次指定此选项。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>s</option> <replaceable>repo_uri_or_path</replaceable></term>
<listitem><para>对位于给定 URI 或文件系统路径的系统信息库进行操作。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo diff</command> [<option>vq</option>] [<option>-strict</option>] [<option>-parsable</option>] [<option>p</option> <replaceable>publisher</replaceable>]... <option>s</option> <replaceable>first_repo_uri_or_path</replaceable>... [<option>-key</option> <replaceable>ssl_key</replaceable> <option>-cert</option> <replaceable>ssl_cert</replaceable>]... <option>s</option> <replaceable>second_repo_uri_or_path</replaceable>... [<option>-key</option> <replaceable>ssl_key</replaceable> <option>-cert</option> <replaceable>ssl_cert</replaceable>]...</term>
<listitem><para>比较两个系统信息库并显示二者之间的差异。</para>
<para>输出文件开头的 <literal>-</literal> 符号仅指示在第一个系统信息库中找到的项目，而 <literal>+</literal> 符号仅指示在第二个系统信息库中找到的项目。开头没有符号说明它是通用项目。
</para>
<variablelist termlength="wholeline">
<varlistentry><term><option>v</option></term>
<listitem><para>包括用于详述比较的输出（包括 per-fmri 输出）。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>q</option></term>
<listitem><para>执行静默比较；将不生成任何输出。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-strict</option></term>
<listitem><para>比较上次修改目录的时间戳。这可用于确定一个系统信息库是否为另一个系统信息库的确切克隆。</para>
</listitem>
<varlistentry><term><option>-parsable</option></term>
<listitem><para>以 JSON 格式生成可解析的输出。</para>
</listitem>
</varlistentry>
</varlistentry>
<varlistentry><term><option>p</option> <replaceable>publisher</replaceable></term>
<listitem><para>仅针对指定发布者执行操作。如果没有指定发布者或者指定了特定值 <literal>all</literal>，则对所有发布者执行操作。可以多次指定此选项。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>s</option> <replaceable>repo_uri_or_path</replaceable></term>
<listitem><para>对位于给定 URI 或文件系统路径的系统信息库进行操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><option>-key</option> <replaceable>ssl_key</replaceable> <option>-cert</option> <replaceable>ssl_cert</replaceable></term>
<listitem><para>使用 <option>-key</option> 选项指定用于从 HTTPS 系统信息库进行软件包检索的客户机 SSL 密钥文件。使用 <option>-cert</option> 选项指定用于从 HTTPS 系统信息库进行软件包检索的客户机 SSL 证书文件。可以多次指定此选项对。在第一个 <option>s</option> 之后、第二个 <option>s</option> 之前指定的对将应用于第一个系统信息库。在第二个 <option>s</option> 之后指定的对将应用于第二个系统信息库。</para>
</listitem>
</varlistentry>
</variablelist>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo help</command></term>
<listitem><para>显示用法消息。</para>
</listitem>
</varlistentry>
<varlistentry><term><command>pkgrepo version</command></term>
<listitem><para>Display a unique string that identifies the version of the <olink targetdoc="refman" targetptr="pkg-7"><citerefentry><refentrytitle>pkg</refentrytitle><manvolnum>7</manvolnum></citerefentry></olink> system.由 <command>version</command> 操作生成的值不能进行排序，并且对于在不平等情况下的比较而言是不安全的。</para>
</listitem>
</varlistentry>
</variablelist>
</refsect1>
<refsect1 role="examples"><title></title>
<example><title>创建软件包系统信息库</title>
<screen>$ <userinput>pkgrepo create /my/repository</userinput></screen>
</example>
<example><title>Display Information</title>
<para>显示发布者摘要以及系统信息库中软件包的数量。
</para>
<screen>$ <userinput>pkgrepo info -s /my/repository</userinput>
PUBLISHER   PACKAGES STATUS UPDATED
example.com 5        online 2011-07-22T18:09:09.769106Z
$ <userinput>pkgrepo info -s http://pkg.oracle.com/solaris/release/</userinput>
PUBLISHER PACKAGES STATUS UPDATED
solaris   3941     online 2010-11-12T19:24:25.967246Z</screen>
</example>
<example><title>重新生成目录和搜索数据</title>
<para>重新生成系统信息库的目录和搜索数据。</para>
<screen>$ <userinput>pkgrepo rebuild -s /my/repository</userinput></screen>
</example>
<example><title>刷新目录和搜索数据</title>
<para>刷新系统信息库的目录和搜索数据。</para>
<screen>$ <userinput>pkgrepo refresh -s /my/repository</userinput>
$ <userinput>pkgrepo refresh -s http://example.com/repository</userinput></screen>
</example>
<example><title>显示所有系统信息库属性</title>
<screen>$ <userinput>pkgrepo get -s /export/repoSolaris11</userinput>
SECTION    PROPERTY    VALUE
publisher  prefix      solaris
repository description Local&bsol; copy&bsol; of&bsol; the&bsol; Oracle&bsol; Solaris&bsol; 11&bsol; repository
repository name        Oracle&bsol; Solaris&bsol; 11
repository version     4
$ <userinput>pkgrepo get -s http://pkg.oracle.com/solaris/release/</userinput>
SECTION    PROPERTY VALUE
deployment content  s11_11-11
deployment pubdate  20111102T222051Z
publisher  prefix   solaris
repository version  4</screen>
</example>
<example><title>显示所有发布者属性</title>
<screen>$ <userinput>pkgrepo get -s http://pkg.oracle.com/solaris/release/ -p all</userinput>
PUBLISHER SECTION    PROPERTY         VALUE
solaris   publisher  alias
solaris   publisher  prefix           solaris
solaris   repository collection-type  core
solaris   repository description      This&bsol; repository&bsol; serves&bsol; the&bsol; Oracle&bsol;
Solaris&bsol; 11&bsol; Package&bsol; repository.
solaris   repository legal-uris       ()
solaris   repository mirrors          (http://pkg-cdn1.oracle.com/solaris.release/)
solaris   repository name             Oracle&bsol; Solaris&bsol; 11&bsol; Package&bsol; Repository
solaris   repository origins          ()
solaris   repository refresh-seconds
solaris   repository registration-uri ""
solaris   repository related-uris     ()</screen>
</example>
<example><title>设置缺省发布者</title>
<screen>$ <userinput>pkgrepo set -s /my/repository publisher/prefix=example.com</userinput></screen>
</example>
<example><title>设置发布者属性</title>
<screen>$ <userinput>pkgrepo set -s /my/repository -p example.com &bsol;</userinput>
<userinput>repository/origins=http://example.com/repository</userinput></screen>
</example>
<example><title>将新的发布者添加到系统信息库中</title>
<screen>$ <userinput>pkgrepo add-publisher -s /my/repository example.com</userinput></screen>
</example>
</refsect1>
<refsect1 role="exit-status"><title></title>
<para>将返回以下退出值：</para>
<variablelist>
<varlistentry><term><returnvalue>0</returnvalue></term>
<listitem><para>命令成功（或者对于 pkgrepo diff 未遇到任何差异）。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>1</returnvalue></term>
<listitem><para>出现错误。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>2</returnvalue></term>
<listitem><para>指定的命令行选项无效。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>3</returnvalue></term>
<listitem><para>请求了多项操作，但只有一部分操作成功。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>4</returnvalue></term>
<listitem><para>没有进行更改时，无需执行任何操作。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>5</returnvalue></term>
<listitem><para>针对 pkgrepo diff 找到了差异。</para>
</listitem>
</varlistentry>
<varlistentry><term><returnvalue>99</returnvalue></term>
<listitem><para>发生了意外的异常。</para>
</listitem>
</varlistentry>
</variablelist>
</refsect1>
<refsect1 role="attributes"><title></title>
<para>有关下列属性的说明，请参见 <olink targetdoc="refman" targetptr="attributes-7"><citerefentry><refentrytitle>attributes</refentrytitle><manvolnum>7</manvolnum></citerefentry></olink>：</para>
<informaltable frame="all" orient="port">
<textobject>
<simpara>表中显示适用的属性类型及相关值。</simpara>
</textobject>
<tgroup cols="2" colsep="1" rowsep="1"><colspec colname="col1" colwidth="198*" align="left" /><colspec colname="col2" colwidth="198*" align="left" /><thead>
<row>
<entry align="center">
<para>ATTRIBUTE TYPE</para>
</entry>
<entry align="center">
<para>ATTRIBUTE VALUE</para>
</entry>
</row>
</thead>
<tbody>
<row>
<entry align="left">
<para>可用性</para>
</entry>
<entry align="left">
<para><literal>package/pkg</literal></para>
</entry>
</row>
<row>
<entry align="left">
<para>接口稳定性</para>
</entry>
<entry align="left">
<para>Uncommitted（未确定）</para>
</entry>
</row>
</tbody>
</tgroup>
</informaltable></refsect1>
<refsect1 role="see-also"><title></title>
<para><olink targetdoc="refman" targetptr="pkg-1"><citerefentry><refentrytitle>pkg</refentrytitle><manvolnum>1</manvolnum></citerefentry></olink>、<olink targetdoc="refman" targetptr="pkgrecv-1"><citerefentry><refentrytitle>pkgrecv</refentrytitle><manvolnum>1</manvolnum></citerefentry></olink>、<olink targetdoc="refman" targetptr="pkgsend-1"><citerefentry><refentrytitle>pkgsend</refentrytitle><manvolnum>1</manvolnum></citerefentry></olink>、<olink targetdoc="refman" targetptr="pkg.depotd-8"><citerefentry><refentrytitle>pkg.depotd</refentrytitle><manvolnum>8</manvolnum></citerefentry></olink>、<olink targetdoc="refman" targetptr="pkg-7"><citerefentry><refentrytitle>pkg</refentrytitle><manvolnum>7</manvolnum></citerefentry></olink></para>
<para><olink targetdoc="CCOSP">《<citetitle remap="book">在 Oracle Solaris 11.4 中创建软件包系统信息库</citetitle>》</olink></para>
<para><literal>https://github.com/oracle/solaris-ips</literal></para>
</refsect1>
<refsect1 role="notes"><title></title>
<para>大多数 <command>pkgrepo</command> 操作不可用于软件包归档文件。A package archive is a file, typically with a <filename>.p5p</filename> extension, as described in the <option>a</option> option in the <olink targetdoc="refman" targetptr="pkgrecv-1"><citerefentry><refentrytitle>pkgrecv</refentrytitle><manvolnum>1</manvolnum></citerefentry></olink> man page.软件包归档文件包含软件包但不包含系统信息库配置。但是，<command>pkgrepo list</command>、<command>pkgrepo info</command> 和 <command>pkgrepo contents</command> 命令适用于软件包归档文件。</para>
</refsect1>
</refentry>
